cmake_minimum_required(VERSION 3.10)
project(core VERSION 0.0)
set(CMAKE_C_COMPILER mpicc)
add_executable(game src/coordinator.c src/io/init_state_setter.c src/io/interpolation_t.c src/io/set_grid_props_and_dt.c src/io/write_output.c src/spatial_operators/coriolis_gen.c src/spatial_operators/div.c src/spatial_operators/kinetic_energy.c src/spatial_operators/pot_vort.c src/spatial_operators/calc_tendencies.c src/spatial_operators/grad.c src/spatial_operators/linear_combine_two_states.c src/spatial_operators/scalar_times_vector.c src/spatial_operators/scalar_times_scalar.c src/spatial_operators/dissipation.c src/time_stepping/manage_time_stepping.c src/time_stepping/vertical_slice_solver.c src/time_stepping/lower_boundary_solver.c src/time_stepping/time_stepping.h src/diagnostics/thermodynamical_diagnostics.c src/diagnostics/ricci.c src/diagnostics/diffusion_diagnostics.c src/diagnostics/global_scalar_integral.c src/diagnostics/recover_components/trsk_modified.c src/diagnostics/recover_components/recov_hor_ver_pri.c src/diagnostics/recover_components/recov_ver_0_curl.c src/diagnostics/recover_components/recov_ver_0_pri.c src/diagnostics/recover_components/recov_ver_1_curl.c src/diagnostics/recover_components/recov_ver_1_pri.c src/diagnostics/recover_components/recov_hor_par_pri.c)
add_definitions(-Wall)
find_package(OpenMP)
SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${OpenMP_C_FLAGS}")
SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -O3")
target_link_libraries(game eccodes m netcdf geos95 rte-rrtmgp-c atmostracers)
install(TARGETS game DESTINATION core)
install(FILES ../core/run.sh DESTINATION core)
install(DIRECTORY DESTINATION output)
install(DIRECTORY ../test_generator/nc_files/ DESTINATION input)
install(DIRECTORY ../grid_generator/nc_files/ DESTINATION grids)
enable_testing()
